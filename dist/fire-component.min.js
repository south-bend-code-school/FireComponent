/*!
 * fire-component v1.0.0
 * (c) 2019 David Mattia
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.FireComponent=e():t.FireComponent=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=23)}([function(t,e){t.exports=function(t,e,n,i,o){var r,a=t=t||{},s=typeof t.default;"object"!==s&&"function"!==s||(r=t,a=t.default);var l="function"==typeof a?a.options:a;e&&(l.render=e.render,l.staticRenderFns=e.staticRenderFns),i&&(l._scopeId=i);var c;if(o?(c=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},l._ssrRegister=c):n&&(c=n),c){var u=l.functional,d=u?l.render:l.beforeCreate;u?l.render=function(t,e){return c.call(e),d(t,e)}:l.beforeCreate=d?[].concat(d,c):[c]}return{esModule:r,exports:a,options:l}}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{path:{required:!0,validator:function(){throw new Error("NOT IMPLEMENTED")}},customTag:{type:String,default:"div"}},data:function(){return{componentEditable:!1,isEditing:!1,shownVal:this.value,sourceChanged:!1,updating:!1,isBlurring:!1,showEditableIndicator:!1}},created:function(){this.$fc_permission.bus.$on("permissionChange",this.editableMixinPermissionChange)},beforeDestroy:function(){this.$fc_permission.bus.$off("permissionChange",this.editableMixinPermissionChange)},watch:{content:function(t,e){(this.isEditing||e!==this.shownVal)&&this.componentEditable||(this.shownVal=t)},reference:{handler:function(t){var e=this;t&&(this.loading=!0,this.loadData(t).catch(function(){}).then(function(){e.loading=!1,e.shownVal=e.content}))},immediate:!0},shownVal:function(t){var e=this;this.$nextTick(function(){e.$refs.editElement&&(e.$refs.editElement.innerText=t)})}},computed:{reference:function(){throw new Error("NOT IMPLEMENTED")}},methods:{editableMixinPermissionChange:function(t){this.componentEditable=!!t},editableOnFocus:function(){this.isEditing=!0,this.isBlurring=!1},editableOnBlur:function(){var t=this;this.isBlurring=!0,setTimeout(function(){t.isEditing=!t.isBlurring},10)},editableOnInput:function(t){this.shownVal=t.target.textContent},editableOnSave:function(){var t=this;this.updating=!0,this.shownVal=this.$refs.editElement.textContent,this.updateData(this.shownVal).then(function(){t.updating=!1})},editableOnCancel:function(){this.shownVal=this.content},loadData:function(){throw new Error("NOT IMPLEMENTED")},updateData:function(){throw new Error("NOT IMPLEMENTED")},editableOnMouseOver:function(){this.showEditableIndicator=!0},editableOnMouseLeave:function(){this.showEditableIndicator=!1}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.VALID_DOC_PATH=/^\/?[A-Za-z0-9_]+\/[A-Za-z0-9_]+(\/[A-Za-z0-9_]+\/[A-Za-z0-9_]+)*\/?$/,e.VALID_COLL_PATH=/^\/?[A-Za-z0-9_]+(\/[A-Za-z0-9_]+\/[A-Za-z0-9_]+)*\/?$/,e.VALID_FIELD_PATH=/^[A-Za-z0-9_]+(\.[A-Za-z0-9_]+)*$/},function(t,e,n){"use strict";function i(t){this.bus=new t,this.permissionChange=function(){for(var t,e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];(t=this.bus).$emit.apply(t,["permissionChange"].concat(n))}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";function i(t){this.bus=new t,this.send=function(t){this.bus.$emit(t)},this.save=function(){this.send("save")},this.reset=function(){this.send("reset")}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";function i(t){this.bus=new t,this.newUpload=function(){for(var t,e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];(t=this.bus).$emit.apply(t,["newUpload"].concat(n))}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){function i(t){n(27)}var o=n(0)(n(14),n(37),i,"data-v-2ca2147c",null);t.exports=o.exports},function(t,e,n){function i(t){n(29)}var o=n(0)(n(15),n(39),i,"data-v-6bca1b64",null);t.exports=o.exports},function(t,e,n){function i(t){n(28)}var o=n(0)(n(16),n(38),i,"data-v-2d7d06d5",null);t.exports=o.exports},function(t,e,n){function i(t){n(26)}var o=n(0)(n(17),n(36),i,"data-v-1f05abb9",null);t.exports=o.exports},function(t,e,n){function i(t){n(31)}var o=n(0)(n(18),n(41),i,"data-v-bc5945b8",null);t.exports=o.exports},function(t,e,n){function i(t){n(25)}var o=n(0)(n(19),n(35),i,null,null);t.exports=o.exports},function(t,e,n){function i(t){n(30)}var o=n(0)(n(20),n(40),i,"data-v-b6463ee2",null);t.exports=o.exports},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"fire-input",props:{path:{required:!0,type:[String]},editable:{required:!0,type:[Boolean]},useTransaction:{type:[Boolean],default:!1},customTag:{type:[String],default:"span"},editorStyle:{type:[Object],default:function(){return Object.create(null)}}},data:function(){return{content:null,snapshotVal:null,editableContentSnapshot:null,unsub:null,hasChanges:!1,saving:!1,error:null,startTime:null,isLoaded:!1,firebaseRef:this.$firebase.database().ref(this.path),editorKey:"editor-"+Math.random().toString(36).substring(4)}},watch:{editable:function(t){t||this.updateContent()},snapshotVal:function(t){this.editable&&this.isLoaded||(this.isLoaded=!0,this.updateContent())}},methods:{updateContent:function(){this.hasChanges=!1,this.content=this.snapshotVal,this.editableContentSnapshot=this.snapshotVal},finished:function(){var t=this;this.$nextTick(function(){t.error||t.reset(),t.saving=!1})},save:function(){var t=this;this.saving=!0,this.useTransaction&&"number"==typeof this.snapshotVal?this.firebaseRef.transaction(function(e){return e+(t.snapshotVal.constructor(t.editableContentSnapshot)-t.content)},function(e,n,i){e?t.error=e:n||(t.error="Did not save."),t.finished()},!1):this.firebaseRef.set(this.snapshotVal.constructor(this.editableContentSnapshot)).catch(function(e){t.error=e}).then(this.finished)},reset:function(){var t=this;this.updateContent(),this.$nextTick(function(){t.$refs.editor.innerText!==t.editableContentSnapshot&&(t.$refs.editor.innerText=t.editableContentSnapshot)})},contentChangeEventHandler:function(t){this.editableContentSnapshot=t.target.innerText}},mounted:function(){var t=this;this.isLoaded=!1,this.unsub=this.firebaseRef.on("value",function(e){t.hasChanges=!0,t.snapshotVal=e.exists()?e.val():null}),this.$fc_messenger.bus.$on("save",this.save),this.$fc_messenger.bus.$on("reset",this.reset)},beforeDestroy:function(){this.unsub&&this.firebaseRef.off("value",this.unsub)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"FireComponentInlineEditor",props:{value:{type:[String,Number],required:!0},editable:{required:!0,type:[Boolean]},customTag:{type:[String],default:"span"},editorStyle:{type:[Object],default:function(){return Object.create(null)}}},data:function(){return{uniqueKey:"firecomponent--inline-editor--"+this.$uniqId,isEditing:!1}},computed:{title:function(){return this.editable?"Click to Edit":null}},methods:{contentChangeEventHandler:function(t){this.$emit("input",t)},startEdit:function(t){this.isEditing=this.editable},stopEdit:function(t){this.isEditing=!1},attemptStop:function(t){this.isEditing=this.$refs.editor===document.activeElement}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=function(t){return t&&t.__esModule?t:{default:t}}(i),r=n(3),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r);e.default={mixins:[o.default],name:"FireComponent-Firestore-Number",props:{path:{required:!0,validator:function(t){return t.hasOwnProperty("firestore")&&t.hasOwnProperty("collection")||a.VALID_DOC_PATH.test(t)}},fieldPath:{type:Array,required:!0,validator:function(t){return t.reduce(function(t,e){return t&&e.constructor===String})}}},data:function(){return{document:null}},computed:{content:function(){try{return this.fieldPath.reduce(function(t,e){return t[e]},this.document)||0}catch(t){return 0}},reference:function(){return"string"==typeof this.path?this.$firebase.firestore().doc(this.path):this.path}},methods:{loadData:function(t){var e=this;return new Promise(function(n,i){e.$bindAsObject("document",t,i,n)})},updateData:function(t){return this.reference.update(this.fieldPath.join("."),t)},editableOnInput:function(t){this.shownVal=Number(t.target.textContent.replace(/[^0-9\.]/g,""))}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=function(t){return t&&t.__esModule?t:{default:t}}(i),r=n(3),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r);e.default={mixins:[o.default],name:"FireComponent-Firestore-Text",props:{path:{required:!0,validator:function(t){return t.hasOwnProperty("firestore")&&t.hasOwnProperty("collection")||a.VALID_DOC_PATH.test(t)}},fieldPath:{type:Array,required:!0,validator:function(t){return t.reduce(function(t,e){return t&&e.constructor===String})}}},data:function(){return{document:null}},computed:{content:function(){try{return this.fieldPath.reduce(function(t,e){return t[e]},this.document)||""}catch(t){return""}},reference:function(){return"string"==typeof this.path?this.$firebase.firestore().doc(this.path):this.path}},methods:{loadData:function(t){var e=this;return new Promise(function(n,i){e.$bindAsObject("document",t,i,n)})},updateData:function(t){return this.reference.update(this.fieldPath.join("."),t)}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),o=function(t){return t&&t.__esModule?t:{default:t}}(i),r=n(21),a=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r);e.default={mixins:[o.default],name:"FireComponent-RTDB-Text",props:{path:{required:!0,validator:function(t){return t.hasOwnProperty("root")||a.VALID_PATH.test(t)}}},data:function(){return{json:null}},computed:{content:function(){try{return this.json[".value"]||""}catch(t){return""}},reference:function(){return this.$firebase.database().ref(this.path)}},methods:{loadData:function(t){var e=this;return new Promise(function(n,i){e.$bindAsObject("json",t,i,n)})},updateData:function(t){return this.reference.set(t)}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(24);!function(t){t&&t.__esModule}(i);e.default={name:"FireImageEditor",data:function(){return{event:null,croppie:null,location:null,task:null,config:null,tasks:{},uploading:!1,watchers:{}}},created:function(){this.$fc_image.bus.$on("newUpload",this.handleUpload)},computed:{storageRef:function(){return this.$firebase.storage().refFromURL(this.location||"")},fileURL:function(){return this.files.length?window.URL.createObjectURL(this.files[0]):""},files:function(){return this.event?this.event.target.files:[]},viewport:function(){if(!this.config)return null;var t=.8*this.boundary.width,e={type:this.config.circle?"circle":"square"};return this.config.aspectRatio>1?(e.width=t,e.height=t/this.config.aspectRatio):(e.width=t/this.config.aspectRatio,e.height=t),e},boundary:function(){var t=.8*window.innerWidth,e=.5*window.innerHeight,n=Math.min(t,e);return{width:n,height:n}},imageFormat:function(){return this.config?this.config.circle?"png":this.config.format:null},allowOrientation:function(){return!!this.config&&this.config.enableOrientation}},methods:{initializeCroppie:function(){var t=this;this.$nextTick(function(){t.croppie=new window.Croppie(t.$refs.croppie,{enforceBoundary:t.config.enforceBoundary,enableOrientation:t.config.enableOrientation,viewport:t.viewport,boundary:t.boundary}),t.croppie.bind({url:t.fileURL})})},handleUpload:function(t,e,n){if(this.event||e.target.files.length<=0)return this.$fc_image.bus.$emit(t+"-cancelled",e);this.event=e,this.location=t,this.config=n,this.initializeCroppie()},rotate:function(t){this.croppie&&this.allowOrientation&&this.croppie.rotate(t)},cancel:function(){this.$fc_image.bus.$emit(this.location+"-cancelled",this.e);var t=this.tasks[this.location];t&&t.length&&t.forEach(function(t){t.cancel()}),this.teardown()},teardown:function(){this.destroyCroppie(),this.location=null,this.event=null,this.config=null},destroyCroppie:function(){this.croppie&&(this.croppie.destroy(),this.croppie=null)},upload:function(){var t=this,e=this.location,n=this.event;this.tasks[e]=[],this.uploading=!0,Promise.all(this.config.widths.map(function(e,n){var i=t.storageRef.child(n+"");return t.getCroppedImage(e).then(function(e){return t.uploadToCloudStorage(e,i)})})).then(function(i){e===t.location&&(t.teardown(),t.uploading=!1),t.tasks[e]=null,t.$fc_image.bus.$emit(e+"-completed",n,i.map(function(t){return t.downloadURL}))})},getCroppedImage:function(t){return this.croppie.result({type:"blob",size:{width:t},format:this.imageFormat,circle:this.config.circle,quality:this.config.quality||1})},uploadToCloudStorage:function(t,e){var n=e.put(t);return this.tasks[this.location].push(n),n},continueWithoutWaiting:function(){this.teardown(),this.uploading=!1}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(22),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(i);e.default={name:"fire-image",props:{path:{type:[Object,String],required:!0,validator:function(t){return!!t.bucket&&"string"==typeof t.bucket||o.VALID_PATH.test(t)}},editable:{type:[Boolean],default:function(){return!1}},aspectRatio:{type:[Number],default:function(){return 1}},widths:{type:[Array],default:function(){return[320,500]}},quality:{type:[Number],default:function(){return 1}},circle:{type:[Boolean],default:function(){return!1}},enforceBoundary:{type:[Boolean],default:function(){return!0}},allowRotations:{type:[Boolean],default:function(){return!0}},bgColor:{type:[String],default:"inherit"},noImageText:{type:[String],default:"No Image"},textColor:{type:[String],default:"#909090"}},data:function(){return{newUpload:!1,index:null,imageURL:"",showEdit:!1,width:0,height:0,loading:!0}},computed:{showEditBtn:function(){return this.editable&&this.showEdit},uniqueName:function(){return Math.random().toString(36).substring(4)},padding:function(){return 1/this.aspectRatio},format:function(){return this.quality<1?"jpeg":"png"},reference:function(){if(this.path)try{return"string"==typeof this.path?this.$firebase.storage().ref(this.path):this.$firebase.storage().refFromURL(this.path.toString())}catch(t){return console.error(t),null}},displayURL:function(){return this.imageURL||"\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' version='1.1' height='"+50/this.aspectRatio+"px' width='50px'><text text-anchor='middle' x='25' y='"+25/this.aspectRatio+"' fill='"+this.textColor+"' font-size='5'>"+(this.loading?"Loading...":this.noImageText)+'</text></svg>"'}},watch:{reference:{handler:function(t){var e=this;this.$nextTick(function(){t&&e.loadFromStorage(t)})},immediate:!0}},methods:{loadFromStorage:function(t){var e=this;this.loading=!0,this.imageURL="",t=t.child(""+this.getIndexToDisplay()),t.getDownloadURL().then(function(n){t.parent.toString()===e.reference.toString()&&(e.imageURL=n)}).catch(function(t){console.error(t)}).then(function(){e.loading=!1})},getIndexToDisplay:function(){var t=this.$refs.root.clientWidth,e={index:0,offset:null};return this.widths.forEach(function(n,i){var o=Math.abs(n-t);(null===e.offset||o<e.offset)&&(e={index:i,offset:o})}),this.index=e.index,e.index},imageUploaded:function(t){var e=this.reference.toString(),n={widths:this.widths,aspectRatio:this.aspectRatio,enforceBoundary:this.enforceBoundary,allowRotations:this.allowRotations,circle:this.circle,format:this.format};this.$fc_image.bus.$on(e+"-cancelled",this.newCancelledCallback(e)),this.$fc_image.bus.$on(e+"-completed",this.newCompletedCallback(e)),this.$fc_image.newUpload(e,t,n)},newCancelledCallback:function(t){var e=this;return function n(){e.$fc_image.bus.$off(t+"-cancelled",n)}},newCompletedCallback:function(t){var e=this;return function n(i,o){e.$fc_image.bus.$off(t+"-completed",n);var r=e.getIndexToDisplay();o[r]?e.imageURL=o[r]:e.loadFromStorage(e.reference)}}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.VALID_PATH=/^\/?[A-Za-z0-9_]+(\/[A-Za-z0-9_]+)*\/?$/},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.VALID_PATH=/^\/?[A-Za-z0-9_]+(\/[A-Za-z0-9_]+)*\/?$/},function(t,e,n){"use strict";(function(t){function i(t){return t&&t.__esModule?t:{default:t}}function o(t){t.prototype.$fc_image=new L.default(t),t.prototype.$fc_messenger=new M.default(t),t.prototype.$fc_permission=new T.default(t)}function r(t){Object.defineProperty(t.prototype,"$uniqId",{get:function(){return this._uid}})}function a(t,e,n,i){var o=window.document.createElement(i||"div");o.id=n,window.document.body.appendChild(o),new t({el:"#"+n,render:function(t){return t(e)}})}function s(t){a(t,C.default,"firecomponent--image-editor","div")}function l(t){t.component("fire-image",E.default),t.component("fire-input",f.default),t.component("fire-text",y.default),t.component("fire-inline-editor",h.default),t.component("rtdb-text",y.default),t.component("firestore-text",b.default),t.component("firestore-number",v.default),t.component("storage-image",E.default)}function c(t,e){if("object"!==(void 0===e?"undefined":u(e)))return void console.error("You must add your firebase configuration object to the firecomponent library");t.prototype.$firebase=e,o(t),r(t),s(t),l(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.FireInput=e.StorageImage=void 0;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.install=c;var d=n(7),f=i(d),p=n(8),h=i(p),m=n(9),v=i(m),g=n(10),b=i(g),w=n(11),y=i(w),_=n(12),C=i(_),x=n(13),E=i(x),O=n(4),T=i(O),I=n(6),L=i(I),R=n(5),M=i(R);e.StorageImage=E.default,e.FireInput=f.default;var P={install:c};e.default=P;var $=null;"undefined"!=typeof window?$=window.Vue:void 0!==t&&($=t.Vue),$&&($.initializeApp=function(t){Vue.use(P,t)})}).call(e,n(1))},function(t,e,n){(function(n){var i,o,r;!function(n,a){o=[e],i=a,void 0!==(r="function"==typeof i?i.apply(e,o):i)&&(t.exports=r)}(0,function(e){function i(t){if(t in Q)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=K.length;n--;)if((t=K[n]+e)in Q)return t}function o(t,e){var n=G.indexOf(t)>-1?G:J,i=n.indexOf(t),o=e/90%n.length;return n[(n.length+i+o%n.length)%n.length]}function r(t,e){t=t||{};for(var n in e)e[n]&&e[n].constructor&&e[n].constructor===Object?(t[n]=t[n]||{},r(t[n],e[n])):t[n]=e[n];return t}function a(t){return r({},t)}function s(t){if("createEvent"in document){var e=document.createEvent("HTMLEvents");e.initEvent("change",!1,!0),t.dispatchEvent(e)}else t.fireEvent("onchange")}function l(t,e,n){if("string"==typeof e){var i=e;e={},e[i]=n}for(var o in e)t.style[o]=e[o]}function c(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function u(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(e,"")}function d(t,e){for(var n in e)t.setAttribute(n,e[n])}function f(t){return parseInt(t,10)}function p(t,e){var n=new Image;return n.style.opacity=0,new Promise(function(i){function o(){n.style.opacity=1,setTimeout(function(){i(n)},1)}n.removeAttribute("crossOrigin"),t.match(/^https?:\/\/|^\/\//)&&n.setAttribute("crossOrigin","anonymous"),n.onload=function(){e?EXIF.getData(n,function(){o()}):o()},n.src=t})}function h(t,e){var n=t.naturalWidth,i=t.naturalHeight,o=e||m(t);if(o&&o>=5){var r=n;n=i,i=r}return{width:n,height:i}}function m(t){return t.exifdata?t.exifdata.Orientation:1}function v(t,e,n){var i=e.width,o=e.height,r=t.getContext("2d");switch(t.width=e.width,t.height=e.height,r.save(),n){case 2:r.translate(i,0),r.scale(-1,1);break;case 3:r.translate(i,o),r.rotate(180*Math.PI/180);break;case 4:r.translate(0,o),r.scale(1,-1);break;case 5:t.width=o,t.height=i,r.rotate(90*Math.PI/180),r.scale(1,-1);break;case 6:t.width=o,t.height=i,r.rotate(90*Math.PI/180),r.translate(0,-o);break;case 7:t.width=o,t.height=i,r.rotate(-90*Math.PI/180),r.translate(-i,o),r.scale(1,-1);break;case 8:t.width=o,t.height=i,r.translate(0,i),r.rotate(-90*Math.PI/180)}r.drawImage(e,0,0,i,o),r.restore()}function g(){var t,e,n,i,o,r=this,a=r.options.viewport.type?"cr-vp-"+r.options.viewport.type:null;r.options.useCanvas=r.options.enableOrientation||b.call(r),r.data={},r.elements={},t=r.elements.boundary=document.createElement("div"),e=r.elements.viewport=document.createElement("div"),r.elements.img=document.createElement("img"),n=r.elements.overlay=document.createElement("div"),r.options.useCanvas?(r.elements.canvas=document.createElement("canvas"),r.elements.preview=r.elements.canvas):r.elements.preview=r.elements.img,c(t,"cr-boundary"),t.setAttribute("aria-dropeffect","none"),i=r.options.boundary.width,o=r.options.boundary.height,l(t,{width:i+(isNaN(i)?"":"px"),height:o+(isNaN(o)?"":"px")}),c(e,"cr-viewport"),a&&c(e,a),l(e,{width:r.options.viewport.width+"px",height:r.options.viewport.height+"px"}),e.setAttribute("tabindex",0),c(r.elements.preview,"cr-image"),d(r.elements.preview,{alt:"preview","aria-grabbed":"false"}),c(n,"cr-overlay"),r.element.appendChild(t),t.appendChild(r.elements.preview),t.appendChild(e),t.appendChild(n),c(r.element,"croppie-container"),r.options.customClass&&c(r.element,r.options.customClass),O.call(this),r.options.enableZoom&&_.call(r),r.options.enableResize&&w.call(r)}function b(){return this.options.enableExif&&window.EXIF}function w(){function t(t){if((void 0===t.button||0===t.button)&&(t.preventDefault(),!h)){var l=f.elements.overlay.getBoundingClientRect();if(h=!0,o=t.pageX,r=t.pageY,i=-1!==t.currentTarget.className.indexOf("vertical")?"v":"h",a=l.width,s=l.height,t.touches){var c=t.touches[0];o=c.pageX,r=c.pageY}window.addEventListener("mousemove",e),window.addEventListener("touchmove",e),window.addEventListener("mouseup",n),window.addEventListener("touchend",n),document.body.style[Y]="none"}}function e(t){var e=t.pageX,n=t.pageY;if(t.preventDefault(),t.touches){var c=t.touches[0];e=c.pageX,n=c.pageY}var u=e-o,d=n-r,h=f.options.viewport.height+d,v=f.options.viewport.width+u;"v"===i&&h>=m&&h<=s?(l(p,{height:h+"px"}),f.options.boundary.height+=d,l(f.elements.boundary,{height:f.options.boundary.height+"px"}),f.options.viewport.height+=d,l(f.elements.viewport,{height:f.options.viewport.height+"px"})):"h"===i&&v>=m&&v<=a&&(l(p,{width:v+"px"}),f.options.boundary.width+=u,l(f.elements.boundary,{width:f.options.boundary.width+"px"}),f.options.viewport.width+=u,l(f.elements.viewport,{width:f.options.viewport.width+"px"})),T.call(f),M.call(f),E.call(f),I.call(f),r=n,o=e}function n(){h=!1,window.removeEventListener("mousemove",e),window.removeEventListener("touchmove",e),window.removeEventListener("mouseup",n),window.removeEventListener("touchend",n),document.body.style[Y]=""}var i,o,r,a,s,u,d,f=this,p=document.createElement("div"),h=!1,m=50;c(p,"cr-resizer"),l(p,{width:this.options.viewport.width+"px",height:this.options.viewport.height+"px"}),this.options.resizeControls.height&&(u=document.createElement("div"),c(u,"cr-resizer-vertical"),p.appendChild(u)),this.options.resizeControls.width&&(d=document.createElement("div"),c(d,"cr-resizer-horisontal"),p.appendChild(d)),u&&(u.addEventListener("mousedown",t),u.addEventListener("touchstart",t)),d&&(d.addEventListener("mousedown",t),d.addEventListener("touchstart",t)),this.elements.boundary.appendChild(p)}function y(t){if(this.options.enableZoom){var e=this.elements.zoomer,n=z(t,4);e.value=Math.max(e.min,Math.min(e.max,n))}}function _(){function t(){C.call(n,{value:parseFloat(o.value),origin:new nt(n.elements.preview),viewportRect:n.elements.viewport.getBoundingClientRect(),transform:et.parse(n.elements.preview)})}function e(e){var i,o;if("ctrl"===n.options.mouseWheelZoom&&!0!==e.ctrlKey)return 0;i=e.wheelDelta?e.wheelDelta/1200:e.deltaY?e.deltaY/1060:e.detail?e.detail/-60:0,o=n._currentZoom+i*n._currentZoom,e.preventDefault(),y.call(n,o),t.call(n)}var n=this,i=n.elements.zoomerWrap=document.createElement("div"),o=n.elements.zoomer=document.createElement("input");c(i,"cr-slider-wrap"),c(o,"cr-slider"),o.type="range",o.step="0.0001",o.value=1,o.style.display=n.options.showZoomer?"":"none",o.setAttribute("aria-label","zoom"),n.element.appendChild(i),i.appendChild(o),n._currentZoom=1,n.elements.zoomer.addEventListener("input",t),n.elements.zoomer.addEventListener("change",t),n.options.mouseWheelZoom&&(n.elements.boundary.addEventListener("mousewheel",e),n.elements.boundary.addEventListener("DOMMouseScroll",e))}function C(t){function e(){var t={};t[X]=i.toString(),t[q]=r.toString(),l(n.elements.preview,t)}var n=this,i=t?t.transform:et.parse(n.elements.preview),o=t?t.viewportRect:n.elements.viewport.getBoundingClientRect(),r=t?t.origin:new nt(n.elements.preview);if(n._currentZoom=t?t.value:n._currentZoom,i.scale=n._currentZoom,n.elements.zoomer.setAttribute("aria-valuenow",n._currentZoom),e(),n.options.enforceBoundary){var a=x.call(n,o),s=a.translate,c=a.origin;i.x>=s.maxX&&(r.x=c.minX,i.x=s.maxX),i.x<=s.minX&&(r.x=c.maxX,i.x=s.minX),i.y>=s.maxY&&(r.y=c.minY,i.y=s.maxY),i.y<=s.minY&&(r.y=c.maxY,i.y=s.minY)}e(),it.call(n),I.call(n)}function x(t){var e=this,n=e._currentZoom,i=t.width,o=t.height,r=e.elements.boundary.clientWidth/2,a=e.elements.boundary.clientHeight/2,s=e.elements.preview.getBoundingClientRect(),l=s.width,c=s.height,u=i/2,d=o/2,f=-1*(u/n-r),p=f-(l*(1/n)-i*(1/n)),h=-1*(d/n-a),m=h-(c*(1/n)-o*(1/n)),v=1/n*u,g=l*(1/n)-v,b=1/n*d;return{translate:{maxX:f,minX:p,maxY:h,minY:m},origin:{maxX:g,minX:v,maxY:c*(1/n)-b,minY:b}}}function E(){var t=this,e=t._currentZoom,n=t.elements.preview.getBoundingClientRect(),i=t.elements.viewport.getBoundingClientRect(),o=et.parse(t.elements.preview.style[X]),r=new nt(t.elements.preview),a=i.top-n.top+i.height/2,s=i.left-n.left+i.width/2,c={},u={};c.y=a/e,c.x=s/e,u.y=(c.y-r.y)*(1-e),u.x=(c.x-r.x)*(1-e),o.x-=u.x,o.y-=u.y;var d={};d[q]=c.x+"px "+c.y+"px",d[X]=o.toString(),l(t.elements.preview,d)}function O(){function t(t,e){var n=h.elements.preview.getBoundingClientRect(),i=p.y+e,o=p.x+t;h.options.enforceBoundary?(f.top>n.top+e&&f.bottom<n.bottom+e&&(p.y=i),f.left>n.left+t&&f.right<n.right+t&&(p.x=o)):(p.y=i,p.x=o)}function e(t){h.elements.preview.setAttribute("aria-grabbed",t),h.elements.boundary.setAttribute("aria-dropeffect",t?"move":"none")}function n(t){var e=37,n=38,o=39,r=40;if(!t.shiftKey||t.keyCode!==n&&t.keyCode!==r){if(h.options.enableKeyMovement&&t.keyCode>=37&&t.keyCode<=40){t.preventDefault();var a=function(t){switch(t){case e:return[1,0];case n:return[0,1];case o:return[-1,0];case r:return[0,-1]}}(t.keyCode);p=et.parse(h.elements.preview),document.body.style[Y]="none",f=h.elements.viewport.getBoundingClientRect(),i(a)}}else{var s=0;s=t.keyCode===n?parseFloat(h.elements.zoomer.value,10)+parseFloat(h.elements.zoomer.step,10):parseFloat(h.elements.zoomer.value,10)-parseFloat(h.elements.zoomer.step,10),h.setZoom(s)}}function i(e){var n=e[0],i=e[1],o={};t(n,i),o[X]=p.toString(),l(h.elements.preview,o),T.call(h),document.body.style[Y]="",E.call(h),I.call(h),d=0}function o(t){if((void 0===t.button||0===t.button)&&(t.preventDefault(),!m)){if(m=!0,c=t.pageX,u=t.pageY,t.touches){var n=t.touches[0];c=n.pageX,u=n.pageY}e(m),p=et.parse(h.elements.preview),window.addEventListener("mousemove",r),window.addEventListener("touchmove",r),window.addEventListener("mouseup",a),window.addEventListener("touchend",a),document.body.style[Y]="none",f=h.elements.viewport.getBoundingClientRect()}}function r(e){e.preventDefault();var n=e.pageX,i=e.pageY;if(e.touches){var o=e.touches[0];n=o.pageX,i=o.pageY}var r=n-c,a=i-u,f={};if("touchmove"===e.type&&e.touches.length>1){var m=e.touches[0],v=e.touches[1],g=Math.sqrt((m.pageX-v.pageX)*(m.pageX-v.pageX)+(m.pageY-v.pageY)*(m.pageY-v.pageY));d||(d=g/h._currentZoom);var b=g/d;return y.call(h,b),void s(h.elements.zoomer)}t(r,a),f[X]=p.toString(),l(h.elements.preview,f),T.call(h),u=i,c=n}function a(){m=!1,e(m),window.removeEventListener("mousemove",r),window.removeEventListener("touchmove",r),window.removeEventListener("mouseup",a),window.removeEventListener("touchend",a),document.body.style[Y]="",E.call(h),I.call(h),d=0}var c,u,d,f,p,h=this,m=!1;h.elements.overlay.addEventListener("mousedown",o),h.elements.viewport.addEventListener("keydown",n),h.elements.overlay.addEventListener("touchstart",o)}function T(){if(this.elements){var t=this,e=t.elements.boundary.getBoundingClientRect(),n=t.elements.preview.getBoundingClientRect();l(t.elements.overlay,{width:n.width+"px",height:n.height+"px",top:n.top-e.top+"px",left:n.left-e.left+"px"})}}function I(){var t,e=this,n=e.get();if(L.call(e))if(e.options.update.call(e,n),e.$&&"undefined"==typeof Prototype)e.$(e.element).trigger("update.croppie",n);else{var t;window.CustomEvent?t=new CustomEvent("update",{detail:n}):(t=document.createEvent("CustomEvent"),t.initCustomEvent("update",!0,!0,n)),e.element.dispatchEvent(t)}}function L(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function R(){var t=this,e={},n=t.elements.preview,i=null,o=new et(0,0,1),r=new nt;L.call(t)&&!t.data.bound&&(t.data.bound=!0,e[X]=o.toString(),e[q]=r.toString(),e.opacity=1,l(n,e),i=t.elements.preview.getBoundingClientRect(),t._originalImageWidth=i.width,t._originalImageHeight=i.height,t.data.orientation=m(t.elements.img),t.options.enableZoom?M.call(t,!0):t._currentZoom=1,o.scale=t._currentZoom,e[X]=o.toString(),l(n,e),t.data.points.length?P.call(t,t.data.points):$.call(t),E.call(t),T.call(t))}function M(t){var e,n,i,o,r=this,a=0,l=r.options.maxZoom||1.5,c=r.elements.zoomer,u=parseFloat(c.value),d=r.elements.boundary.getBoundingClientRect(),f=h(r.elements.img,r.data.orientation),p=r.elements.viewport.getBoundingClientRect();r.options.enforceBoundary&&(i=p.width/f.width,o=p.height/f.height,a=Math.max(i,o)),a>=l&&(l=a+1),c.min=z(a,4),c.max=z(l,4),!t&&(u<c.min||u>c.max)?y.call(r,u<c.min?c.min:c.max):t&&(n=Math.max(d.width/f.width,d.height/f.height),e=null!==r.data.boundZoom?r.data.boundZoom:n,y.call(r,e)),s(c)}function P(t){if(4!==t.length)throw"Croppie - Invalid number of points supplied: "+t;var e=this,n=t[2]-t[0],i=e.elements.viewport.getBoundingClientRect(),o=e.elements.boundary.getBoundingClientRect(),r={left:i.left-o.left,top:i.top-o.top},a=i.width/n,s=t[1],c=t[0],u=-1*t[1]+r.top,d=-1*t[0]+r.left,f={};f[q]=c+"px "+s+"px",f[X]=new et(d,u,a).toString(),l(e.elements.preview,f),y.call(e,a),e._currentZoom=a}function $(){var t=this,e=t.elements.preview.getBoundingClientRect(),n=t.elements.viewport.getBoundingClientRect(),i=t.elements.boundary.getBoundingClientRect(),o=n.left-i.left,r=n.top-i.top,a=o-(e.width-n.width)/2,s=r-(e.height-n.height)/2,c=new et(a,s,t._currentZoom);l(t.elements.preview,X,c.toString())}function S(t){var e=this,n=e.elements.canvas,i=e.elements.img,o=n.getContext("2d"),r=b.call(e),t=e.options.enableOrientation&&t;if(o.clearRect(0,0,n.width,n.height),n.width=i.width,n.height=i.height,r&&!t){v(n,i,f(m(i)||0,10))}else t&&v(n,i,t)}function k(t){var e=this,n=t.points,i=f(n[0]),o=f(n[1]),r=f(n[2]),a=f(n[3]),s=r-i,l=a-o,c=t.circle,u=document.createElement("canvas"),d=u.getContext("2d"),p=t.outputWidth||s,h=t.outputHeight||l;t.outputWidth&&t.outputHeight;return u.width=p,u.height=h,t.backgroundColor&&(d.fillStyle=t.backgroundColor,d.fillRect(0,0,p,h)),!1!==e.options.enforceBoundary&&(s=Math.min(s,e._originalImageWidth),l=Math.min(l,e._originalImageHeight)),d.drawImage(this.elements.preview,i,o,s,l,0,0,p,h),c&&(d.fillStyle="#fff",d.globalCompositeOperation="destination-in",d.beginPath(),d.arc(u.width/2,u.height/2,u.width/2,0,2*Math.PI,!0),d.closePath(),d.fill()),u}function j(t){var e=t.points,n=document.createElement("div"),i=document.createElement("img"),o=e[2]-e[0],r=e[3]-e[1];return c(n,"croppie-result"),n.appendChild(i),l(i,{left:-1*e[0]+"px",top:-1*e[1]+"px"}),i.src=t.url,l(n,{width:o+"px",height:r+"px"}),n}function A(t){return k.call(this,t).toDataURL(t.format,t.quality)}function F(t){var e=this;return new Promise(function(n,i){k.call(e,t).toBlob(function(t){n(t)},t.format,t.quality)})}function B(t){this.elements.img.parentNode&&(Array.prototype.forEach.call(this.elements.img.classList,function(e){t.classList.add(e)}),this.elements.img.parentNode.replaceChild(t,this.elements.img),this.elements.preview=t),this.elements.img=t}function D(t,e){var n,i=this,o=[],r=null,a=b.call(i);if("string"==typeof t)n=t,t={};else if(Array.isArray(t))o=t.slice();else{if(void 0===t&&i.data.url)return R.call(i),I.call(i),null;n=t.url,o=t.points||[],r=void 0===t.zoom?null:t.zoom}return i.data.bound=!1,i.data.url=n||i.data.url,i.data.boundZoom=r,p(n,a).then(function(n){if(B.call(i,n),o.length)i.options.relative&&(o=[o[0]*n.naturalWidth/100,o[1]*n.naturalHeight/100,o[2]*n.naturalWidth/100,o[3]*n.naturalHeight/100]);else{var r,a,s=h(n),l=i.elements.viewport.getBoundingClientRect(),c=l.width/l.height,u=s.width/s.height;u>c?(a=s.height,r=a*c):(r=s.width,a=s.height/c);var d=(s.width-r)/2,f=(s.height-a)/2,p=d+r,m=f+a;i.data.points=[d,f,p,m]}i.data.points=o.map(function(t){return parseFloat(t)}),i.options.useCanvas&&S.call(i,t.orientation||1),R.call(i),I.call(i),e&&e()}).catch(function(t){console.error("Croppie:"+t)})}function z(t,e){return parseFloat(t).toFixed(e||0)}function Z(){var t=this,e=t.elements.preview.getBoundingClientRect(),n=t.elements.viewport.getBoundingClientRect(),i=n.left-e.left,o=n.top-e.top,r=(n.width-t.elements.viewport.offsetWidth)/2,a=(n.height-t.elements.viewport.offsetHeight)/2,s=i+t.elements.viewport.offsetWidth+r,l=o+t.elements.viewport.offsetHeight+a,c=t._currentZoom;(c===1/0||isNaN(c))&&(c=1);var u=t.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return i=Math.max(u,i/c),o=Math.max(u,o/c),s=Math.max(u,s/c),l=Math.max(u,l/c),{points:[z(i),z(o),z(s),z(l)],zoom:c,orientation:t.data.orientation}}function N(t){var e=this,n=Z.call(e),i=r(a(ot),a(t)),o="string"==typeof t?t:i.type||"base64",s=i.size||"viewport",l=i.format,c=i.quality,u=i.backgroundColor,d="boolean"==typeof i.circle?i.circle:"circle"===e.options.viewport.type,f=e.elements.viewport.getBoundingClientRect(),p=f.width/f.height;return"viewport"===s?(n.outputWidth=f.width,n.outputHeight=f.height):"object"==typeof s&&(s.width&&s.height?(n.outputWidth=s.width,n.outputHeight=s.height):s.width?(n.outputWidth=s.width,n.outputHeight=s.width/p):s.height&&(n.outputWidth=s.height*p,n.outputHeight=s.height)),rt.indexOf(l)>-1&&(n.format="image/"+l,n.quality=c),n.circle=d,n.url=e.data.url,n.backgroundColor=u,new Promise(function(t,i){switch(o.toLowerCase()){case"rawcanvas":t(k.call(e,n));break;case"canvas":case"base64":t(A.call(e,n));break;case"blob":F.call(e,n).then(t);break;default:t(j.call(e,n))}})}function V(){R.call(this)}function H(t){if(!this.options.useCanvas||!this.options.enableOrientation)throw"Croppie: Cannot rotate without enableOrientation && EXIF.js included";var e=this,n=e.elements.canvas;e.data.orientation=o(e.data.orientation,t),v(n,e.elements.img,e.data.orientation),M.call(e),C.call(e),copy=null}function W(){var t=this;t.element.removeChild(t.elements.boundary),u(t.element,"croppie-container"),t.options.enableZoom&&t.element.removeChild(t.elements.zoomerWrap),delete t.elements}function U(t,e){if(t.className.indexOf("croppie-container")>-1)throw new Error("Croppie: Can't initialize croppie more than once");if(this.element=t,this.options=r(a(U.defaults),e),"img"===this.element.tagName.toLowerCase()){var n=this.element;c(n,"cr-original-image"),d(n,{"aria-hidden":"true",alt:""});var i=document.createElement("div");this.element.parentNode.appendChild(i),i.appendChild(n),this.element=i,this.options.url=this.options.url||n.src}if(g.call(this),this.options.url){var o={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,D.call(this,o)}}"function"!=typeof Promise&&function(e){function i(t,e){return function(){t.apply(e,arguments)}}function o(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],u(t,i(a,this),i(s,this))}function r(t){var e=this;return null===this._state?void this._deferreds.push(t):void f(function(){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return void(e._state?t.resolve:t.reject)(e._value);var i;try{i=n(e._value)}catch(e){return void t.reject(e)}t.resolve(i)})}function a(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if("function"==typeof e)return void u(i(e,t),i(a,this),i(s,this))}this._state=!0,this._value=t,l.call(this)}catch(t){s.call(this,t)}}function s(t){this._state=!1,this._value=t,l.call(this)}function l(){for(var t=0,e=this._deferreds.length;e>t;t++)r.call(this,this._deferreds[t]);this._deferreds=null}function c(t,e,n,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=i}function u(t,e,n){var i=!1;try{t(function(t){i||(i=!0,e(t))},function(t){i||(i=!0,n(t))})}catch(t){if(i)return;i=!0,n(t)}}var d=setTimeout,f="function"==typeof n&&n||function(t){d(t,1)},p=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var n=this;return new o(function(i,o){r.call(n,new c(t,e,i,o))})},o.all=function(){var t=Array.prototype.slice.call(1===arguments.length&&p(arguments[0])?arguments[0]:arguments);return new o(function(e,n){function i(r,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(t){i(r,t)},n)}t[r]=a,0==--o&&e(t)}catch(t){n(t)}}if(0===t.length)return e([]);for(var o=t.length,r=0;r<t.length;r++)i(r,t[r])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(t){return new o(function(e,n){n(t)})},o.race=function(t){return new o(function(e,n){for(var i=0,o=t.length;o>i;i++)t[i].then(e,n)})},o._setImmediateFn=function(t){f=t},void 0!==t&&t.exports?t.exports=o:e.Promise||(e.Promise=o)}(this),"function"!=typeof window.CustomEvent&&function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}t.prototype=window.Event.prototype,window.CustomEvent=t}(),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,e,n){for(var i=atob(this.toDataURL(e,n).split(",")[1]),o=i.length,r=new Uint8Array(o),a=0;a<o;a++)r[a]=i.charCodeAt(a);t(new Blob([r],{type:e||"image/png"}))}});var q,X,Y,K=["Webkit","Moz","ms"],Q=document.createElement("div").style,G=[1,8,3,6],J=[2,7,4,5];X=i("transform"),q=i("transformOrigin"),Y=i("userSelect");var tt={translate3d:{suffix:", 0px"},translate:{suffix:""}},et=function(t,e,n){this.x=parseFloat(t),this.y=parseFloat(e),this.scale=parseFloat(n)};et.parse=function(t){return t.style?et.parse(t.style[X]):t.indexOf("matrix")>-1||t.indexOf("none")>-1?et.fromMatrix(t):et.fromString(t)},et.fromMatrix=function(t){var e=t.substring(7).split(",");return e.length&&"none"!==t||(e=[1,0,0,1,0,0]),new et(f(e[4]),f(e[5]),parseFloat(e[0]))},et.fromString=function(t){var e=t.split(") "),n=e[0].substring(U.globals.translate.length+1).split(","),i=e.length>1?e[1].substring(6):1,o=n.length>1?n[0]:0,r=n.length>1?n[1]:0;return new et(o,r,i)},et.prototype.toString=function(){var t=tt[U.globals.translate].suffix||"";return U.globals.translate+"("+this.x+"px, "+this.y+"px"+t+") scale("+this.scale+")"};var nt=function(t){if(!t||!t.style[q])return this.x=0,void(this.y=0);var e=t.style[q].split(" ");this.x=parseFloat(e[0]),this.y=parseFloat(e[1])};nt.prototype.toString=function(){return this.x+"px "+this.y+"px"};var it=function(t,e,n){var i;return function(){var o=this,r=arguments,a=function(){i=null,n||t.apply(o,r)},s=n&&!i;clearTimeout(i),i=setTimeout(a,e),s&&t.apply(o,r)}}(T,500),ot={type:"canvas",format:"png",quality:1},rt=["jpeg","webp","png"];if(window.jQuery){var at=window.jQuery;at.fn.croppie=function(t){if("string"==typeof t){var e=Array.prototype.slice.call(arguments,1),n=at(this).data("croppie");return"get"===t?n.get():"result"===t?n.result.apply(n,e):"bind"===t?n.bind.apply(n,e):this.each(function(){var n=at(this).data("croppie");if(n){var i=n[t];if(!at.isFunction(i))throw"Croppie "+t+" method not found";i.apply(n,e),"destroy"===t&&at(this).removeData("croppie")}})}return this.each(function(){var e=new U(this,t);e.$=at,at(this).data("croppie",e)})}}U.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},resizeControls:{width:!0,height:!0},customClass:"",showZoomer:!0,enableZoom:!0,enableResize:!1,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,enableKeyMovement:!0,update:function(){}},U.globals={translate:"translate3d"},r(U.prototype,{bind:function(t,e){return D.call(this,t,e)},get:function(){var t=Z.call(this),e=t.points;return this.options.relative&&(e[0]/=this.elements.img.naturalWidth/100,e[1]/=this.elements.img.naturalHeight/100,e[2]/=this.elements.img.naturalWidth/100,e[3]/=this.elements.img.naturalHeight/100),t},result:function(t){return N.call(this,t)},refresh:function(){return V.call(this)},setZoom:function(t){y.call(this,t),s(this.elements.zoomer)},rotate:function(t){H.call(this,t)},destroy:function(){return W.call(this)}}),e.Croppie=window.Croppie=U})}).call(e,n(34).setImmediate)},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(t){if(u===setTimeout)return setTimeout(t,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function r(t){if(d===clearTimeout)return clearTimeout(t);if((d===i||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(t);try{return d(t)}catch(e){try{return d.call(null,t)}catch(e){return d.call(this,t)}}}function a(){m&&p&&(m=!1,p.length?h=p.concat(h):v=-1,h.length&&s())}function s(){if(!m){var t=o(a);m=!0;for(var e=h.length;e;){for(p=h,h=[];++v<e;)p&&p[v].run();v=-1,e=h.length}p=null,m=!1,r(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var u,d,f=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(t){u=n}try{d="function"==typeof clearTimeout?clearTimeout:i}catch(t){d=i}}();var p,h=[],m=!1,v=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new l(t,e)),1!==h.length||m||o(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,n){(function(t,e){!function(t,n){"use strict";function i(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[l]=i,s(l),l++}function o(t){delete c[t]}function r(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(n,i)}}function a(t){if(u)setTimeout(a,0,t);else{var e=c[t];if(e){u=!0;try{r(e)}finally{o(t),u=!1}}}}if(!t.setImmediate){var s,l=1,c={},u=!1,d=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?function(){s=function(t){e.nextTick(function(){a(t)})}}():function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&a(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),s=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){a(t.data)},s=function(e){t.port2.postMessage(e)}}():d&&"onreadystatechange"in d.createElement("script")?function(){var t=d.documentElement;s=function(e){var n=d.createElement("script");n.onreadystatechange=function(){a(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():function(){s=function(t){setTimeout(a,0,t)}}(),f.setImmediate=i,f.clearImmediate=o}}("undefined"==typeof self?void 0===t?this:t:self)}).call(e,n(1),n(32))},function(t,e,n){(function(t){function i(t,e){this._id=t,this._clearFn=e}var o=Function.prototype.apply;e.setTimeout=function(){return new i(o.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new i(o.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(33),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(e,n(1))},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.event,expression:"event"}],ref:"root",staticClass:"firecomponent--image-editor--container"},[n("div",{staticClass:"firecomponent--image-editor--vertical-aligner"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.uploading,expression:"!uploading"}]},[t._t("croppie-header",[n("h1",{staticClass:"firecomponent--image-editor--header"},[t._v("Crop Photo")])]),t._v(" "),n("div",{staticClass:"firecomponent--image-editor--croppie-wrapper"},[n("div",{ref:"croppie"})]),t._v(" "),n("div",{staticClass:"firecomponent--image-editor--controls"},[t._t("croppie-controls",[t.allowOrientation?n("button",{staticClass:"firecomponent--button",on:{click:function(e){t.rotate(-90)}}},[t._v("Rotate Left")]):t._e(),t._v(" "),t.allowOrientation?n("button",{staticClass:"firecomponent--button",on:{click:function(e){t.rotate(90)}}},[t._v("Rotate Right")]):t._e(),t._v(" "),n("button",{staticClass:"firecomponent--button",on:{click:t.cancel}},[t._v("Cancel")]),t._v(" "),n("button",{staticClass:"firecomponent--button",on:{click:t.upload}},[t._v("Complete")])],{rotate:t.rotate,cancel:t.cancel,upload:t.upload})],2)],2),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.uploading,expression:"uploading"}],staticClass:"firecomponent--image-editor--uploading-controls"},[t._t("uploading",[n("button",{staticClass:"firecomponent--button",on:{click:t.cancel}},[t._v("Cancel Upload")]),t._v(" "),n("button",{staticClass:"firecomponent--button",on:{click:t.continueWithoutWaiting}},[t._v("Continue Without Waiting")])],{cancel:t.cancel,noWait:t.continueWithoutWaiting})],2)])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.customTag,{tag:"component",staticClass:"firecomponent--editable-root",class:{"firecomponent--editing":t.isEditing,"firecomponent--editable-indicator":t.showEditableIndicator&&t.componentEditable||t.isEditing},on:{mouseover:t.editableOnMouseOver,mouseleave:t.editableOnMouseLeave,focusin:t.editableOnFocus,focusout:t.editableOnBlur}},[t.showEditableIndicator&&t.componentEditable||t.isEditing?n("div",{ref:"editElement",attrs:{contenteditable:"true"},on:{change:t.editableOnInput}},[t._v(t._s(t.shownVal))]):t.shownVal?[t._v(t._s(t.shownVal))]:n("span",{staticClass:"firecomponent-editable-placeholder"},[t._v("placeholder")]),t.updating?n("div",{staticClass:"firecomponent--loader-container"},[n("div",{staticClass:"firecomponent--loader"})]):t._e(),t.isEditing?n("div",{staticClass:"firecomponent--editable-controls"},[n("button",{staticClass:"firecomponent--btn firecomponent--save-btn",attrs:{tabindex:"0"},on:{click:function(e){return e.stopPropagation(),t.editableOnSave(e)}}},[t._v("Save")]),n("button",{staticClass:"firecomponent--btn firecomponent--cancel-btn",attrs:{tabindex:"0"},on:{click:function(e){return e.stopPropagation(),t.editableOnCancel(e)}}},[t._v("Cancel")])]):t._e()],2)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.customTag,{tag:"component"},[t.editable?n("span",{key:t.editorKey,ref:"editor",staticClass:"editor",style:t.editorStyle,attrs:{contenteditable:"true"},on:{input:t.contentChangeEventHandler}},[t._v("\n    "+t._s(t.content)+"\n  ")]):t._t("display",[t._v("\n    "+t._s(t.content)+"\n  ")],{content:t.content})],2)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.customTag,{tag:"component",staticClass:"firecomponent--editable-root",class:{"firecomponent--editing":t.isEditing,"firecomponent--editable-indicator":t.showEditableIndicator&&t.componentEditable||t.isEditing},on:{mouseover:t.editableOnMouseOver,mouseleave:t.editableOnMouseLeave,focusin:t.editableOnFocus,focusout:t.editableOnBlur}},[t.showEditableIndicator&&t.componentEditable||t.isEditing?n("div",{ref:"editElement",attrs:{contenteditable:"true"},on:{change:t.editableOnInput}},[t._v(t._s(t.shownVal))]):t.shownVal?[t._v(t._s(t.shownVal))]:n("span",{staticClass:"firecomponent-editable-placeholder"},[t._v("placeholder")]),t.updating?n("div",{staticClass:"firecomponent--loader-container"},[n("div",{staticClass:"firecomponent--loader"})]):t._e(),t.isEditing?n("div",{staticClass:"firecomponent--editable-controls"},[n("button",{staticClass:"firecomponent--btn firecomponent--save-btn",attrs:{tabindex:"0"},on:{click:function(e){return e.stopPropagation(),t.editableOnSave(e)}}},[t._v("Save")]),n("button",{staticClass:"firecomponent--btn firecomponent--cancel-btn",attrs:{tabindex:"0"},on:{click:function(e){return e.stopPropagation(),t.editableOnCancel(e)}}},[t._v("Cancel")])]):t._e()],2)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.customTag,{tag:"component",staticStyle:{width:"100%"},attrs:{title:t.title},on:{mouseover:t.startEdit,mouseleave:t.attemptStop}},[t.isEditing?n("div",{key:t.uniqueKey,ref:"editor",staticClass:"firecomponent--inline-editor",style:t.editorStyle,attrs:{contenteditable:"true"},on:{blur:t.stopEdit,input:t.contentChangeEventHandler}},[t._v("\n    "+t._s(t.value)+"\n  ")]):t._t("display",[t._v("\n    "+t._s(t.value)+"\n  ")],{content:t.value})],2)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"root",staticClass:"firecomponent--fire-image--container",on:{mouseover:function(e){t.showEdit=!0},mouseleave:function(e){t.showEdit=!1}}},[t._t("display",[n("div",{staticClass:"firecomponent--fire-image--display"},[n("div",{staticClass:"firecomponent--fire-image--ratio-enforcer",style:{paddingTop:100*t.padding+"%"}}),t._v(" "),n("div",{staticClass:"firecomponent--fire-image--content",style:{backgroundImage:"url("+t.displayURL+")",backgroundColor:t.bgColor}})])],{src:t.displayURL}),t._v(" "),t.editable?n("div",{staticClass:"firecomponent--fire-image--edit-controller",class:{"firecomponent--fire-image--hide-on-desktop":!t.showEditBtn},on:{click:function(t){t.stopPropagation()}}},[t._t("edit-controller",[n("label",{staticClass:"firecomponent--button firecomponent--fire-image-change-label",attrs:{for:t.uniqueName,title:"Click to upload new image"}},[t._v("\n        Change\n      ")])],{for:t.uniqueName}),t._v(" "),n("input",{attrs:{type:"file",id:t.uniqueName},on:{change:t.imageUploaded}})],2):t._e()],2)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.customTag,{tag:"component",staticClass:"firecomponent--editable-root",class:{"firecomponent--editing":t.isEditing,"firecomponent--editable-indicator":t.showEditableIndicator&&t.componentEditable||t.isEditing},on:{mouseover:t.editableOnMouseOver,mouseleave:t.editableOnMouseLeave,focusin:t.editableOnFocus,focusout:t.editableOnBlur}},[t.showEditableIndicator&&t.componentEditable||t.isEditing?n("div",{ref:"editElement",attrs:{contenteditable:"true"},on:{change:t.editableOnInput}},[t._v(t._s(t.shownVal))]):t.shownVal?[t._v(t._s(t.shownVal))]:n("span",{staticClass:"firecomponent-editable-placeholder"},[t._v("placeholder")]),t.updating?n("div",{staticClass:"firecomponent--loader-container"},[n("div",{staticClass:"firecomponent--loader"})]):t._e(),t.isEditing?n("div",{staticClass:"firecomponent--editable-controls"},[n("button",{staticClass:"firecomponent--btn firecomponent--save-btn",attrs:{tabindex:"0"},on:{click:function(e){return e.stopPropagation(),t.editableOnSave(e)}}},[t._v("Save")]),n("button",{staticClass:"firecomponent--btn firecomponent--cancel-btn",attrs:{tabindex:"0"},on:{click:function(e){return e.stopPropagation(),t.editableOnCancel(e)}}},[t._v("Cancel")])]):t._e()],2)},staticRenderFns:[]}}])});